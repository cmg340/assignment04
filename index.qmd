---
title: "index.qmd"
author: Maeve Grady and Leanne Chook
format: 
  html:
    self-contained: true
editor_options: 
  chunk_output_type: console
---

\vspace{0.1in}

## Visualization 1

```{r}
library(tidyverse)
library(readxl)
library(sf)
library(tigris)
library(rgeoboundaries)
library(readr)
library(ggrepel)
library(janitor)

options(scipen = 999)

# read in the datasets

health_expenditures <- read_excel("nha_indicators.xlsx")
gdppc <- read_excel("gdp.xls")

# make the expenditures dataset wider 
expenditures_wide <- health_expenditures %>%
  select(Countries, Indicators, '2018')

expenditures_wide <- pivot_wider(data = health_expenditures, 
                                 id_cols = Countries, 
                                 names_from = Indicators, 
                                 values_from = '2018'
)

# select only relevant columns 
gdppc2018 <- gdppc %>%
  select(Countries, '2018') %>%
  rename("gdp" = '2018')


# merge the datasets
expenditures <- merge(expenditures_wide, gdppc2018, 
                      by = 'Countries',
                      all.x = TRUE)

# rename variables for ease of coding
expenditures <- expenditures %>%
  rename("population" = `Population (in thousands)`,
         "primary_health" = `Primary Health Care (PHC) Expenditure per Capita in US$`)

# change variables from characters to numeric values 
expenditures <- expenditures %>% 
  mutate(population = as.numeric(population),
         primary_health = as.numeric(primary_health))

expenditures <- expenditures %>% 
  mutate(lngdp = log(gdp),
         population = population/1000)

# plot the graph
expenditures %>%
  ggplot(mapping =
           aes(x = primary_health, 
               y = lngdp, 
               size = population)) +
  geom_point(color = "green", 
             alpha = 0.5) +
  geom_text_repel(mapping = aes(label = Countries), size = 1.5) +

  # set the scale
  scale_size(range = c(1, 15)) +
  
  # add the labels
  labs(x = "Primary Healthcare Expenditure\nper Capita (US$)",
       y = "Natural log of GDP",
       caption = "Source: World Health Organisation and The World Bank", 
       title = "Primary Healthcare Expenditure based on GDP per capita", 
       subtitle = "Does GDP impact spending on primary healthcare?", 
       size = "Population\nin millions"
  ) + 
  
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        axis.title = element_text(size = 8, face = "bold"),
        legend.title = element_text(size = 8, face = "bold"),
        legend.text = element_text(size = 8))


```

\newpage

## Visualization 2

```{r}

```

\newpage

## Visualization 3

```{r}

```

\newpage

## Visualization 4: Pie chart of infant mortality causes 

```{r}
#import mortality data
mortality <- read_excel("mortality.xlsx") %>% clean_names()%>% mutate(value_string = as.numeric(value_string))

###selecting only 2019 data, and only data from each region
mort_19 <- mortality %>% filter(year == 2019, who_region != "Global")


###defining a blank theme
blank_theme <- theme_minimal()+
  theme(
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  panel.border = element_blank(),
  panel.grid=element_blank(),
  axis.ticks = element_blank(),
  plot.title=element_text(size=14, face="bold")
  )


mort_19 %>% ggplot(mapping = aes(x = "" , y = value_string, fill = cause)) +
  geom_bar(width = 1, stat = "identity")+
  coord_polar("y", start= 0)+
  theme_minimal() +
  facet_wrap(~who_region)+ blank_theme +
  theme(axis.text.x=element_blank()) +
  labs(title = "Infant Mortality by cause", 
       subtitle = "Subdivided by World Health Organization region",
       caption = "Data source: World Health Organization, 2019")


```

This is a quick snapshot of what leading causes of infant mortality are accross the world. As is evident by these side-by side comparisons, the Americas, Europe and the Western Pacific experience relatively fewer infant mortalities overall compared to Afria and South East Asia. 

