---
title: "index.qmd"
author: Maeve Grady and Leanne Chook
format: 
  html:
    self-contained: true
editor_options: 
  chunk_output_type: console
---

\vspace{0.1in}

## Loading the Necessary Libraries

```{r}
library(tidyverse)
library(readxl)
library(sf)
library(tigris)
library(rgeoboundaries)
library(readr)
library(ggrepel)

```

## Visualization 1

```{r, fig.width = 11, fig.height = 6.5}
options(scipen = 999)

# read in the datasets

health_expenditures <- read_excel("nha_indicators.xlsx")
gdppc <- read_excel("gdp.xls")

# make the expenditures dataset wider 
expenditures_wide <- health_expenditures %>%
  select(Countries, Indicators, '2018')

expenditures_wide <- pivot_wider(data = health_expenditures, 
                                 id_cols = Countries, 
                                 names_from = Indicators, 
                                 values_from = '2018'
)

# select only relevant columns 
gdppc2018 <- gdppc %>%
  select(Countries, '2018') %>%
  rename("gdp" = '2018')


# merge the datasets
expenditures <- merge(expenditures_wide, gdppc2018, 
                      by = 'Countries',
                      all.x = TRUE)

# rename variables for ease of coding
expenditures <- expenditures %>%
  rename("population" = `Population (in thousands)`,
         "primary_health" = `Primary Health Care (PHC) Expenditure per Capita in US$`)

# change variables from characters to numeric values 
expenditures <- expenditures %>% 
  mutate(population = as.numeric(population),
         primary_health = as.numeric(primary_health))

expenditures <- expenditures %>% 
  mutate(lngdp = log(gdp),
         population = population/1000)

# plot the graph
expenditures %>%
  ggplot(mapping =
           aes(x = primary_health, 
               y = lngdp, 
               size = population)) +
  geom_point(color = "green", 
             alpha = 0.5) +
  geom_text_repel(mapping = aes(label = Countries), size = 2.5) +
  
  # set the scale
  scale_size(range = c(1, 15)) +
  
  # add the labels
  labs(x = "Primary Healthcare Expenditure\nper Capita (US$)",
       y = "Natural log of GDP",
       caption = "Source: World Health Organisation and The World Bank", 
       title = "Primary Healthcare Expenditure based on GDP per capita", 
       subtitle = "Does GDP impact spending on primary healthcare?", 
       size = "Population\nin millions"
  ) + 
  
  # adjust the theme
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        axis.title = element_text(size = 8, face = "bold"),
        legend.title = element_text(size = 8, face = "bold"),
        legend.text = element_text(size = 8))

```

[***Interpretation***]{.underline}

The visualization shows that higher GDP (which has been transformed to natural log) does not necessarily amount to greater spending in primary healthcare. The Scandinavian countries who have higher GDP's tend to spend more on primary healthcare, but other high GDP countries like those in the Middle East spend very little. A majority of the countries are clustered towards the lower end of the expenditure spectrum.

It is also surprising to note that the United States did not have any data on primary healthcare expenditure, and is therefore left out of the graph.

\newpage

## Visualization 2

```{r}

```

\newpage

## Visualization 3

```{r}

```

\newpage

## Visualization 4

```{r}


```