---
title: "index.qmd"
author: Maeve Grady and Leanne Chook
format: 
  html:
    self-contained: true
editor_options: 
  chunk_output_type: console
---

\vspace{0.1in}

## Visualization 1

```{r}
library(tidyverse)
library(readxl)
library(sf)
library(tigris)
library(rgeoboundaries)
library(readr)
library(ggrepel)
library(janitor)
library(rgeoboundaries)
library(sf)

```

\newpage

## Visualization 2

```{r}
world <- geoboundaries()
world

#loading NCD activity data
NCD_activity <- read_csv("NCD_PAC_ADO.csv")

#breaking out by year
ncd_05 <- NCD_activity %>%  filter(TimeDim == 2005)
ncd_15 <- NCD_activity %>%  filter(TimeDim == 2015)

#joining to world spatial data
ncd_geo_05 <- world %>% left_join(ncd_05, 
                                   by = c("shapeISO" = "SpatialDimensionValueCode"),
                                   copy = FALSE,
                                   suffix = c(".x",".y"),
                                   keep = TRUE)                                   
ncd_geo_15 <- world %>% inner_join(ncd_15, 
                                   by = c("shapeISO" = "SpatialDimensionValueCode"),
                                   copy = FALSE,
                                   suffix = c(".x",".y"),
                                   keep = TRUE)                                   



ncd_geo_05 %>% 
  ggplot()+
  geom_sf(aes(fill = NumericValue), color = "white") +
  scale_fill_gradient(
    low = "#752263",
    high = "#d495c4"
  )+
  theme_void()+
  labs(
    title = "Activity level by country in 2005"
  )



```

\newpage

## Visualization 3

```{r}

```

\newpage

## Visualization 4: Pie chart of infant mortality causes 

```{r}
#import mortality data
mortality <- read_excel("mortality.xlsx") %>% clean_names()%>% mutate(value_string = as.numeric(value_string))

###selecting only 2019 data, and only data from each region
mort_19 <- mortality %>% filter(year == 2019, who_region != "Global")


###defining a blank theme
blank_theme <- theme_minimal()+
  theme(
  axis.title.x = element_blank(),
  axis.title.y = element_blank(),
  panel.border = element_blank(),
  panel.grid=element_blank(),
  axis.ticks = element_blank(),
  plot.title=element_text(size=14, face="bold")
  )


mort_19 %>% ggplot(mapping = aes(x = "" , y = value_string, fill = cause)) +
  geom_bar(width = 1, stat = "identity")+
  coord_polar("y", start= 0)+
  theme_minimal() +
  facet_wrap(~who_region)+ blank_theme +
  theme(axis.text.x=element_blank()) +
  labs(title = "Infant Mortality by cause", 
       subtitle = "Subdivided by World Health Organization region",
       caption = "Data source: World Health Organization, 2019")


```

This is a quick snapshot of what leading causes of infant mortality are accross the world. As is evident by these side-by side comparisons, the Americas, Europe and the Western Pacific experience relatively fewer infant mortalities overall compared to Afria and South East Asia. 